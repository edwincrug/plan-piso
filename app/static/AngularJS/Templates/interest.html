<div ng-init="init()">
    <input id="max" name="max" type="hidden">
    <div class="row wrapper border-bottom white-bg page-heading">
        <div class="col-lg-10">
            <h2>Intereses</h2>
            <ol class="breadcrumb">
                <li>
                    <a href="/">Home</a>
                </li>
                <li class="active">
                    <strong>Intereses</strong>
                </li>
            </ol>
        </div>
        <div class="col-lg-2">
        </div>
    </div>
    <div class="input-group">
        <input type="text" class="form-control" ng-model='selectedAgencia' aria-label="...">
        <div class="input-group-btn">
            <button id="btnTotalxEmpresa" type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-loading-text="Obteniendo intereses..." autocomplete="off">Seleccione una marca <span class="caret"></span></button>
            <ul class="dropdown-menu dropdown-menu-right">
                <li ng-repeat="agencia in Agencias">
                    <a href="#" ng-click="update(agencia.model)">{{agencia.model}}</a>
                </li>
            </ul>
        </div>
        <!-- /btn-group -->
    </div>
    <div class="row">
        <div class="col-lg-3">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <span class="label label-success pull-right">HOY</span>
                    <h5>Interés Total</h5>
                </div>
                <div class="ibox-content">
                    <h1 class="no-margins">{{total | currency }}</h1>
                    <div class="stat-percent font-bold text-success">{{porcentajeTotalUnidades}}% <i class="fa"></i></div>
                    <small>Unidades: {{unidades}}</small>
                    <br/>
                    <small><a ng-click="getTotalInterest()">Ver detalles</a></small>
                </div>
            </div>
        </div>
        <div class="col-lg-3">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <span class="label label-warning pull-right">HOY</span>
                    <h5>Interés Por Vencer</h5>
                </div>
                <div class="ibox-content">
                    <h1 class="no-margins">{{interesUnidadesPorVencidas | currency}}</h1>
                    <div class="stat-percent font-bold text-success">{{porcentajePorVencer | number:2}}% <i class="fa"></i></div>
                    <small>Unidades: {{unidadesPorVencer}}</small>
                    <br/>
                    <small><a ng-click="getAlmostEndingInterest()">Ver detalles</a></small>
                </div>
            </div>
        </div>
        <div class="col-lg-3">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <span class="label label-danger pull-right">HOY</span>
                    <h5>Interés Vencido</h5>
                </div>
                <div class="ibox-content">
                    <h1 class="no-margins">{{interesUnidadesVencidas | currency}}</h1>
                    <div class="stat-percent font-bold text-success">{{porcentajeVencido | number:2}}% <i class="fa"></i></div>
                    <small>Unidades: {{unidadesVencidas}}</small>
                    <br/>
                    <small><a ng-click="getEndingInterest()">Ver detalles</a></small>
                </div>
            </div>
        </div>
        <div class="col-lg-3">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <span class="label label-info pull-right">HOY</span>
                    <h5>Interés Vigente</h5>
                </div>
                <div class="ibox-content">
                    <h1 class="no-margins">{{interesRestante | currency}}</h1>
                    <div class="stat-percent font-bold text-success">{{ porcentajeRestante| number:2}}% <i class="fa"></i></div>
                    <small>Unidades: {{unidadesRestantes}}</small>
                    <br/>
                    <small><a ng-click="getNormalInterest()">Ver detalles</a></small>
                </div>
            </div>
        </div>
    </div>
    <h1>Intereses  {{agencia.model}}</h1>
    <div class="wrapper wrapper-content">
        <div class="row">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-content">
                        <div class="table-responsive">
                            <table id="interestTable" class="table table-striped table-bordered table-hover dataTables-example" cg-busy="{promise:promise,message:message}">
                                <thead>
                                    <tr>
                                        <th>VIN</th>
                                        <th>Marca</th>
                                        <th>Modelo</th>
                                        <th>Días plan piso</th>
                                        <th>Precio compra</th>
                                        <th>Precio venta</th>
                                        <th>Interés acumulado</th>
                                        <th>Interés pagado</th>
                                        <th>Saldo total</th>
                                        <th>Margen</th>
                                        <th>Esquema</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="intereses in interes" ng-dblclick="inicia(intereses.VEH_NUMSERIE)">
                                        <td>{{intereses.VEH_NUMSERIE}}</td>
                                        <td>{{intereses.marca}}</td>
                                        <td>{{intereses.modelo}}</td>
                                        <td ng-class="setClassDias(intereses.diasPlanPiso)">{{intereses.diasPlanPiso}}</td>
                                        <td>{{intereses.precioCompra | currency}}</td>
                                        <td>{{intereses.precioVenta | currency}}</td>
                                        <td>{{intereses.interesAcumulado | currency}}</td>
                                        <td>{{intereses.interesPagado | currency}}</td>
                                        <td>{{intereses.interesTotal | currency}}</td>
                                        <td ng-class="setClass(intereses.estatus)">{{intereses.margenGanancia | currency}}</td>
                                        <td>{{intereses.esquema}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal inmodal fade " id="DetallesUnidadModal" href="detailsUnit" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content animated flipInY">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">Detalle Unidades</h4>
            </div>
            <div class="modal-body">
                <div id="detailsUnit" class="detailsUnitScope">
                    <form class="form-signin">
                        <div>
                            Fecha ingreso inventario:
                            <p ng-repeat="detailsUnit in detailsUnit"><span class="label label-primary">{{detailsUnit.VEH_NUMSERIE}}</span></p>
                            Financiera:
                            <p><span class="label label-primary">{{detailsUnit.diasGracia}}</span></p>
                            Tasa interés:
                            <p><span class="label label-primary">{{detailsUnit.plazo}}</span></p>
                            Tipo unidad:
                            <p><span class="label label-primary">{{detailsUnit.TipoUnidad}}</span></p>
                            <p><span class="label label-primary">{{detailsUnit.Ubicacion}}</span></p>
                            <p><span class="label label-primary">{{detailsUnit.fechaInventario}}</span></p>
                            <p><span class="label label-primary">{{detailsUnit.financiera}}</span></p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ***maxima prioridad poner vista de detalles de la unidad con financieras con un boton
    en los  help campos poner la formula de los datos
    query de interes pagao con javier,
    segundo punto imnportantre es la programación de la poliza
    tercero reportes
    
    **** Interés pagado por marcas
    **** Interés por marcas
    **** Crear modal para los detalles de las unidades
    **** Crear modal para mostrar los detalles de las unidades
    **** Terminar el query para mostrar las agencias
    -->